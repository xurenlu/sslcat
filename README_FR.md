# SSLcat - Serveur Proxy SSL

## ‚è±Ô∏è D√©marrage Rapide avec SSLcat en 1 Minute

```bash
# 1) Test rapide local macOS (ou t√©l√©charger le paquet darwin manuellement)
curl -fsSL https://sslcat.com/xurenlu/sslcat/releases/download/v1.0.12/sslcat_1.0.12_darwin_arm64.tar.gz -o sslcat.tgz
tar -xzf sslcat.tgz && sudo install -m 0755 sslcat /usr/local/bin/sslcat
sslcat --config sslcat.conf --port 8080
# Acc√®s navigateur : http://localhost:8080/sslcat-panel/
# Premi√®re connexion : admin / admin*9527
# ‚ö†Ô∏è La premi√®re connexion forcera : 1) Changement de mot de passe 2) Chemin personnalis√© du panneau
# Veuillez vous souvenir du nouveau chemin du panneau d'administration !

# 2) Optionnel : D√©marrage en un clic avec Docker Compose
docker compose up -d
```

SSLcat est un serveur proxy SSL puissant qui prend en charge la gestion automatique des certificats, le transfert de domaines, la protection de s√©curit√© et le panneau d'administration web, avec support des protocoles HTTP/3 (QUIC) et HTTP/2 (n√©gociation automatique, compatible vers le bas).

## üìö Navigation de la Documentation

- üìë [Index Complet de Documentation](DOCS.md) - Index et navigation pour tous les documents
- üìñ [R√©sum√© du Projet](È°πÁõÆÊÄªÁªì.md) - Introduction d√©taill√©e des fonctionnalit√©s et documentation technique
- üöÄ [Guide de D√©ploiement (Chinois)](DEPLOYMENT.md) - Documentation compl√®te de d√©ploiement et d'op√©rations
- üöÄ [Guide de D√©ploiement (Anglais)](DEPLOYMENT_EN.md) - Guide de d√©ploiement anglais

### üåç Versions Multilingues
- üá®üá≥ [‰∏≠Êñá README](README.md) - Version chinoise
- üá∫üá∏ [English README](README_EN.md) - Version anglaise
- üáØüáµ [Êó•Êú¨Ë™û README](README_JA.md) - Version japonaise  
- üá™üá∏ [Espa√±ol README](README_ES.md) - Version espagnole
- üá∑üá∫ [–†—É—Å—Å–∫–∏–π README](README_RU.md) - Version russe

## Caract√©ristiques

### üåè Optimisation R√©seau pour la Chine
- **Optimisation Proxy CDN** : Utilise le service proxy [CDNProxy](https://cdnproxy.some.im/docs)
- **Acc√©l√©ration d'Acc√®s** : R√©sout les probl√®mes d'acc√®s jsdelivr CDN en Chine continentale
- **Stabilit√©** : Assure un chargement stable des ressources via le service proxy

### üîí Gestion Automatique des Certificats SSL
- Obtention automatique de certificats SSL depuis Let's Encrypt
- Support pour le renouvellement automatique des certificats
- Support pour les environnements de staging et de production
- Cache de certificats et optimisation des performances
- **Op√©rations de Certificats en Lot** : T√©l√©chargement/importation de tous les certificats en un clic (format ZIP)

### üîÑ Transfert Intelligent de Domaines
- Transfert proxy intelligent bas√© sur les noms de domaine
- Support pour les protocoles HTTP/HTTPS
- Support pour proxy WebSocket
- Pool de connexions et √©quilibrage de charge

### üõ°Ô∏è M√©canismes de Protection de S√©curit√©
- Blocage IP et contr√¥le d'acc√®s
- Protection anti-force brute
- Validation User-Agent
- Journalisation des acc√®s
- **Empreinte Client TLS** : Identification de client bas√©e sur les caract√©ristiques ClientHello
- **Optimisation Environnement de Production** : Seuils de s√©curit√© plus tol√©rants pour les sc√©narios de trafic √©lev√©

### üéõÔ∏è Panneau d'Administration Web
- Interface web intuitive
- Surveillance et statistiques en temps r√©el
- Gestion des r√®gles de proxy
- Gestion des certificats SSL
- Configuration de s√©curit√©
- **Gestion des Tokens API** : Contr√¥le d'acc√®s API lecture seule/lecture-√©criture
- **Statistiques d'Empreintes TLS** : Donn√©es d'analyse d'empreintes client en temps r√©el

### üîÑ Red√©marrage Gracieux
- Red√©marrage sans temps d'arr√™t
- Pr√©servation des connexions et r√©cup√©ration d'√©tat
- M√©canisme d'arr√™t gracieux

## Exigences Syst√®me

- Syst√®me Linux (Ubuntu/Debian/CentOS/RHEL)
- Go 1.21 ou sup√©rieur
- Privil√®ges root
- Ports 80 et 443 disponibles

## üì• Obtenir le Code Source

### D√©p√¥t GitHub

Projet h√©berg√© sur GitHub : **[https://github.com/xurenlu/sslcat](https://github.com/xurenlu/sslcat)**

### T√©l√©chargement de la Derni√®re Version

```bash
# Cloner le code source le plus r√©cent
git clone https://github.com/xurenlu/sslcat.git
cd sslcat

# Ou t√©l√©charger une version sp√©cifique (recommand√©)
wget https://github.com/xurenlu/sslcat/archive/refs/heads/main.zip
unzip main.zip
cd sslcat-main
```

## üöÄ Installation et D√©ploiement

### Installation Manuelle

1. **Installer les D√©pendances**
```bash
# Ubuntu/Debian
sudo apt-get update
sudo apt-get install -y curl wget git build-essential ca-certificates certbot

# CentOS/RHEL
sudo yum update -y
sudo yum install -y curl wget git gcc gcc-c++ make ca-certificates certbot
```

2. **Installer Go**
```bash
# T√©l√©charger et installer Go 1.21
wget https://go.dev/dl/go1.21.5.linux-amd64.tar.gz
sudo tar -C /usr/local -xzf go1.21.5.linux-amd64.tar.gz
echo 'export PATH=$PATH:/usr/local/go/bin' >> ~/.bashrc
source ~/.bashrc
```

3. **Compiler SSLcat**
```bash
git clone https://github.com/xurenlu/sslcat.git
cd sslcat
go mod download
go build -o sslcat main.go
```

4. **Cr√©er Utilisateur et R√©pertoires**
```bash
sudo useradd -r -s /bin/false sslcat
sudo mkdir -p /etc/sslcat /var/lib/sslcat/{certs,keys,logs}
sudo chown -R sslcat:sslcat /var/lib/sslcat
```

5. **Configurer et D√©marrer**
```bash
sudo cp sslcat /opt/sslcat/
sudo cp sslcat.service /etc/systemd/system/
sudo systemctl daemon-reload
sudo systemctl enable sslcat
sudo systemctl start sslcat
```

## Configuration

### Emplacement du Fichier de Configuration
- Fichier de configuration principal : `/etc/sslcat/sslcat.conf`
- R√©pertoire des certificats : `/var/lib/sslcat/certs`
- R√©pertoire des cl√©s : `/var/lib/sslcat/keys`
- R√©pertoire des logs : `/var/lib/sslcat/logs`

### Configuration de Base

```yaml
server:
  host: "0.0.0.0"
  port: 443
  debug: false

ssl:
  email: "your-email@example.com"  # Email pour certificat SSL
  staging: false                   # Si utiliser l'environnement de staging
  auto_renew: true                 # Renouvellement automatique

admin:
  username: "admin"
  password_file: "/var/lib/sslcat/admin.pass"     # Mot de passe sauvegard√© dans ce fichier, sslcat.conf ne persiste pas password
  first_run: true

proxy:
  rules:
    - domain: "example.com"
      target: "127.0.0.1"
      port: 8080
      enabled: true
      ssl_only: true

security:
  max_attempts: 3                  # Max. tentatives √©chou√©es en 1 minute
  block_duration: "1m"             # Dur√©e du blocage
  max_attempts_5min: 10            # Max. tentatives √©chou√©es en 5 minutes

admin_prefix: "/sslcat-panel"     # Pr√©fixe du chemin du panneau d'administration
```

### R√©cup√©ration de Mot de Passe (R√©cup√©ration d'Urgence)

SSLcat utilise la strat√©gie de s√©curit√© "fichier marqueur + changement forc√© de mot de passe au premier usage" :

- Fichier marqueur : `admin.password_file` (par d√©faut `./data/admin.pass`). Le fichier sauvegarde le mot de passe admin actuel avec permissions 0600.
- Premi√®re connexion : Si le fichier marqueur n'existe pas, ou si le contenu du fichier est toujours le mot de passe par d√©faut `admin*9527`, l'admin sera forc√© √† la page "changer mot de passe" apr√®s connexion r√©ussie pour √©tablir un nouveau mot de passe et √©crire dans le fichier marqueur.

√âtapes de r√©cup√©ration de mot de passe :

1. Arr√™ter le service (ou le maintenir en fonctionnement, arr√™t recommand√©).
2. Supprimer le fichier marqueur (si le chemin a chang√©, supprimer selon le chemin r√©el de configuration) :
   ```bash
   rm -f ./data/admin.pass
   ```
3. Red√©marrer le service, se connecter avec le compte par d√©faut (admin / admin*9527).
4. Le syst√®me forcera l'entr√©e dans la page "changer mot de passe", √©tablir un nouveau mot de passe pour restaurer l'op√©ration normale.

Note : Pour des raisons de s√©curit√©, `sslcat.conf` ne persiste plus `admin.password` en texte clair lors de la sauvegarde ; au moment de l'ex√©cution, le mot de passe r√©el utilise `admin.password_file` comme standard.

## Utilisation

### D√©marrer le Service
```bash
sudo systemctl start sslcat
```

### Arr√™ter le Service
```bash
sudo systemctl stop sslcat
```

### Red√©marrer le Service
```bash
sudo systemctl restart sslcat
```

### Red√©marrage Gracieux
```bash
sudo systemctl reload sslcat
# ou envoyer signal SIGHUP
sudo kill -HUP $(pgrep sslcat)
```

### Voir les Logs
```bash
# Voir l'√©tat du service
sudo systemctl status sslcat

# Voir les logs en temps r√©el
sudo journalctl -u sslcat -f

# Voir les logs d'erreur
sudo journalctl -u sslcat -p err
```

## Panneau d'Administration Web

### Acc√©der au Panneau d'Administration

**‚ö†Ô∏è Important : M√©thode d'Acc√®s Initial**

Comme le syst√®me n'a pas de certificats SSL lors de la premi√®re installation, veuillez utiliser la m√©thode suivante pour l'acc√®s initial :

1. **Premier Acc√®s** (en utilisant l'adresse IP du serveur) :
   ```
   http://YOUR_SERVER_IP/sslcat-panel
   ```
   Note : Utilisez `http://` (pas https) car il n'y a pas encore de certificats SSL

2. **Apr√®s avoir configur√© le domaine et obtenu les certificats** :
   ```
   https://your-domain/your-custom-panel-path
   ```

**Processus de Connexion :**
1. Se connecter avec les identifiants par d√©faut :
   - Nom d'utilisateur : `admin`
   - Mot de passe : `admin*9527`
2. La premi√®re connexion forcera :
   - Changer le mot de passe administrateur
   - Personnaliser le chemin d'acc√®s du panneau (pour la s√©curit√©)
3. **Veuillez vous souvenir du nouveau chemin du panneau !** Le syst√®me redirigera automatiquement vers le nouveau chemin

### Fonctions du Panneau d'Administration
- **Tableau de Bord** : Voir l'√©tat du syst√®me et les statistiques
- **Configuration Proxy** : G√©rer les r√®gles de transfert de domaines
- **Certificats SSL** : Voir et g√©rer les certificats SSL
- **Param√®tres de S√©curit√©** : Configurer les politiques de s√©curit√© et voir les IPs bloqu√©es
- **Param√®tres Syst√®me** : Modifier la configuration syst√®me

## Configuration Proxy

### Ajouter une R√®gle Proxy
1. Se connecter au panneau d'administration
2. Aller √† la page "Configuration Proxy"
3. Cliquer sur "Nouvelle R√®gle Proxy"
4. Remplir la configuration :
   - Domaine : Domaine √† proxifier
   - Cible : IP ou domaine du serveur backend
   - Port : Port du service backend
   - Activ√© : Si activer cette r√®gle
   - SSL Seulement : Si permettre seulement l'acc√®s HTTPS

### Exemple de R√®gle Proxy
```yaml
proxy:
  rules:
    - domain: "api.example.com"
      target: "127.0.0.1"
      port: 3000
      enabled: true
      ssl_only: true
    - domain: "app.example.com"
      target: "192.168.1.100"
      port: 8080
      enabled: true
      ssl_only: false
```

## Gestion des Certificats SSL

### Acquisition Automatique de Certificats
SSLcat obtient automatiquement les certificats SSL pour les domaines configur√©s sans intervention manuelle.

### Renouvellement de Certificats
Les certificats sont automatiquement renouvel√©s 30 jours avant l'expiration, ou peuvent √™tre d√©clench√©s manuellement.

### Stockage de Certificats
- Fichier de certificat : `/var/lib/sslcat/certs/domain.crt`
- Fichier de cl√© priv√©e : `/var/lib/sslcat/keys/domain.key`

## Fonctions de S√©curit√©

### M√©canisme de Blocage IP
- Blocage automatique apr√®s 3 tentatives √©chou√©es en 1 minute
- Blocage automatique apr√®s 10 tentatives √©chou√©es en 5 minutes
- Dur√©e de blocage configurable
- Support pour d√©blocage manuel

### Contr√¥le d'Acc√®s
- Validation User-Agent
- Rejeter l'acc√®s avec User-Agent vide
- Rejeter l'acc√®s avec User-Agent de navigateurs peu communs

### D√©bloquer les IPs
```bash
# Supprimer le fichier de blocage et red√©marrer le service
sudo rm /var/lib/sslcat/sslcat.block
sudo systemctl restart sslcat
```

## Arguments de Ligne de Commande

```bash
sslcat [options]

Options :
  --config string        Chemin du fichier de configuration (par d√©faut : "/etc/sslcat/sslcat.conf")
  --admin-prefix string  Pr√©fixe du chemin du panneau d'administration (par d√©faut : "/sslcat-panel")
  --email string         Email pour certificat SSL
  --staging             Utiliser l'environnement de staging Let's Encrypt
  --port int            Port d'√©coute (par d√©faut : 443)
  --host string         Adresse d'√©coute (par d√©faut : "0.0.0.0")
  --log-level string    Niveau de log (par d√©faut : "info")
  --version             Afficher les informations de version
```

## D√©pannage

### Probl√®mes Courants

1. **√âchec de d√©marrage du service**
   ```bash
   # V√©rifier la syntaxe du fichier de configuration
   sudo withssl --config /etc/sslcat/withssl.conf --log-level debug
   
   # V√©rifier l'utilisation du port
   sudo netstat -tlnp | grep :443
   ```

2. **√âchec d'acquisition de certificat SSL**
   - S'assurer que la r√©solution du domaine soit correcte
   - S'assurer que le port 80 soit accessible
   - V√©rifier les param√®tres du pare-feu
   - Utiliser l'environnement de staging pour les tests

3. **√âchec de transfert proxy**
   - V√©rifier si le serveur cible est atteignable
   - V√©rifier que le port soit correct
   - Consulter les logs d'acc√®s

4. **Panneau d'administration inaccessible**
   - V√©rifier les param√®tres du pare-feu
   - V√©rifier que le certificat SSL soit valide
   - Consulter les logs du service

### Analyse des Logs
```bash
# Voir les logs d√©taill√©s
sudo journalctl -u sslcat -f --no-pager

# Filtrer les logs d'erreur
sudo journalctl -u sslcat -p err --since "1 hour ago"

# Voir les logs d'une p√©riode sp√©cifique
sudo journalctl -u sslcat --since "2024-01-01 00:00:00" --until "2024-01-01 23:59:59"
```

## Optimisation des Performances

### Optimisation Syst√®me
```bash
# Augmenter la limite des descripteurs de fichier
echo "* soft nofile 65536" >> /etc/security/limits.conf
echo "* hard nofile 65536" >> /etc/security/limits.conf

# Optimiser les param√®tres r√©seau
echo "net.core.somaxconn = 65536" >> /etc/sysctl.conf
echo "net.ipv4.tcp_max_syn_backlog = 65536" >> /etc/sysctl.conf
sysctl -p
```

### Optimisation de Configuration
```yaml
server:
  # Activer le mode debug pour l'analyse des performances
  debug: false
  
proxy:
  # Configurer un nombre raisonnable de r√®gles proxy
  rules: []
  
security:
  # Ajuster les param√®tres de s√©curit√©
  max_attempts: 5
  block_duration: "5m"
```

## Optimisation R√©seau

### Optimisation pour les Utilisateurs de Chine Continentale

SSLcat a √©t√© optimis√© pour l'environnement r√©seau de la Chine continentale, utilisant le service proxy [CDNProxy](https://cdnproxy.some.im/docs) pour r√©soudre les probl√®mes d'acc√®s jsdelivr CDN.

#### Utilisation du Proxy CDN
- **Adresse originale** : `https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css`
- **Adresse proxy** : `https://cdnproxy.some.im/cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css`

#### Fichiers de Ressources Impliqu√©s
- Bootstrap 5.1.3 CSS
- Bootstrap Icons 1.7.2
- Bootstrap 5.1.3 JavaScript
- Biblioth√®que Axios JavaScript

#### Contr√¥le d'Acc√®s
Selon la documentation CDNProxy, le service impl√©mente des politiques de contr√¥le d'acc√®s. Si l'acc√®s est bloqu√©, c'est habituellement parce que le domaine Referer de la requ√™te n'est pas dans la liste blanche. Contacter l'administrateur du service pour ajouter votre domaine √† la liste blanche si n√©cessaire.

## Guide de D√©veloppement

### Structure du Projet
```
sslcat/
‚îú‚îÄ‚îÄ main.go                 # Entr√©e principale du programme
‚îú‚îÄ‚îÄ go.mod                  # Fichier de module Go
‚îú‚îÄ‚îÄ internal/               # Paquets internes
‚îÇ   ‚îú‚îÄ‚îÄ config/            # Gestion de configuration
‚îÇ   ‚îú‚îÄ‚îÄ logger/            # Gestion des logs
‚îÇ   ‚îú‚îÄ‚îÄ ssl/               # Gestion des certificats SSL
‚îÇ   ‚îú‚îÄ‚îÄ proxy/             # Gestion proxy
‚îÇ   ‚îú‚îÄ‚îÄ security/          # Gestion de s√©curit√©
‚îÇ   ‚îú‚îÄ‚îÄ web/               # Serveur web
‚îÇ   ‚îî‚îÄ‚îÄ graceful/          # Red√©marrage gracieux
‚îú‚îÄ‚îÄ web/                   # Ressources web
‚îÇ   ‚îú‚îÄ‚îÄ templates/         # Mod√®les HTML
‚îÇ   ‚îî‚îÄ‚îÄ static/            # Ressources statiques
‚îú‚îÄ‚îÄ install.sh             # Script d'installation
‚îî‚îÄ‚îÄ README.md              # Documentation
```

### Configuration de l'Environnement de D√©veloppement
```bash
# Cloner le projet
git clone https://github.com/xurenlu/sslcat.git
cd sslcat

# Installer les d√©pendances
go mod download

# Ex√©cuter le serveur de d√©veloppement
go run main.go --config sslcat.conf --log-level debug
```

### Guide de Contribution
1. Fork du projet
2. Cr√©er une branche de fonctionnalit√©
3. Confirmer les changements
4. Push vers la branche
5. Cr√©er une Pull Request

## Licence

Ce projet utilise la licence MIT. Voir le fichier [LICENSE](LICENSE) pour les d√©tails.

## Support

Si vous rencontrez des probl√®mes ou avez des suggestions :
1. Consulter la section [D√©pannage](#d√©pannage)
2. Rechercher dans [Issues](https://github.com/xurenlu/sslcat/issues)
3. Cr√©er un nouveau Issue
4. Contacter les mainteneurs

## Journal des Modifications

Pour l'historique complet des mises √† jour de version, veuillez consulter : **[CHANGELOG.md](CHANGELOG.md)**

### Derni√®re Version v1.1.0 (2025-09-08)
- D√©lais serveur configurables : `read_timeout_sec`, `write_timeout_sec`, `idle_timeout_sec` (par d√©faut : lecture/√©criture 30min, idle 120s)
- T√©l√©versement am√©lior√© : `max_upload_bytes` (par d√©faut 1 GiB) ; t√©l√©versements cert seul et ZIP en streaming avec limite totale pour √©viter l'usage m√©moire
- Coh√©rence UI : ordre de barre lat√©rale unifi√© ; ajout de "Langue" et "Site Officiel" sur Tableau de bord/Sites statiques/Sites PHP ; correction d'ic√¥nes manquantes
- Connexion & s√©curit√© : captcha d√©sactiv√© temporairement (r√©activable)
- Docs & i18n : READMEs multilingues mis √† jour ; feuille de route mise √† jour

### Derni√®re Version v1.0.15 (2025-01-03)
- üåê Architecture de cluster Master-Slave : Support de d√©ploiement multi-n≈ìuds pour haute disponibilit√©
- üîÑ Synchronisation automatique de configuration : Pouss√©e en temps r√©el du Master vers tous les n≈ìuds Slave
- üîí Contr√¥le de s√©paration des permissions : Restrictions fonctionnelles strictes en mode Slave
- üñ•Ô∏è Interface de gestion de cluster : Surveillance compl√®te de l'√©tat des n≈ìuds et gestion
- üìä Informations de surveillance d√©taill√©es : Adresse IP, port, nombre de certificats, MD5 de configuration, et plus